apiVersion: authentication.kubedoop.dev/v1alpha1
kind: AuthenticationClass
metadata:
  name: ldap
spec:
  provider:
    ldap:
      bindCredentials:
        secretClass: ldap-credentials
      hostname: openldap
      port: 1389
      ldapFieldNames:
        email: mail
        uid: uid
      searchBase: ($LDAP_ROOT_DC)
      searchFilter: ""
---
apiVersion: secrets.kubedoop.dev/v1alpha1
kind: SecretClass
metadata:
  name: ldap-credentials
spec:
  backend:
    k8sSearch:
      searchNamespace:
        pod: {}
---
apiVersion: v1
kind: Secret
metadata:
  name: ldap-credentials
  labels:
    secrets.kubedoop.dev/class: ldap-credentials
type: Opaque
stringData:
  user: ($LDAP_ADMIN_DN)
  password: ($LDAP_ADMIN_PASSWORD)
